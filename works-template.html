<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
  <meta property='og:type' content='website'>
  <meta property='og:title' content='WebデザイナーTARO YAMADA ポートフォリオ'>
  <meta property='og:url' content='URLが入る'>
  <meta property='og:description' content='TARO YAMADAのポートフォリオサイトです。'>
  <meta property="og:image" content="img/ogp.png">
  <meta name="description" content="TARO YAMADAのポートフォリオサイトです" />
  <title>NAGAHO YASUDA ポートフォリオ</title>
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Material+Icons+Outlined" rel="stylesheet">
  <link href="css/ress.css" media="all" rel="stylesheet" type="text/css" />
  <link href="css/style.css" media="all" rel="stylesheet" type="text/css" />
  <link rel="shortcut icon" href="img/favicon.ico" />
  <link rel=”canonical” href=”URLが入る” />
</head>

<body>
  <div class="wrapper">

    <!-- header -->
    <header class="header ">
      <div class="container">
        <h1 class="header-logo">
          <a href=".">NAGAHO YASUDA</a>
        </h1>
        <nav class="gnav">
          <ul class="gnav-list">
            <li class="gnav-item"><a href=".#works">WORKS</a></li>
            <li class="gnav-item"><a href="./#skill">SKILL</a></li>
            <li class="gnav-item"><a href="./#about">ABOUT</a></li>
            <li class="gnav-item"><a href="./#contact">CONTACT</a></li>
          </ul>
        </nav>
      </div>
    </header>
    <!-- /header -->

    <main class="content">

      <article class="article">
        <div class="article-container">
          <h2 class="article-title">見積もり作成ソフト</h2>
          <div class="article-body">
            <div class="Deliverables">
              <h2>目的</h2>
              <li>私個人の過去最長のプログラムの作成、ソフトウェア作成の挑戦</li>
              <li>pythonの習得を通じプログラムへの理解を深める</li>
              <li>現在在籍している会社での導入</li>

              <h2>開発手順</h2>
              
                <li>要件定義</li>
                <li>環境選定</li>
                <li>コーディング</li>
              
  
              <h3>要件定義</h3>
              <p>今回作成した機能 <br>
                フロントエンド：見積もりの作成（データ取得、全ての合計）・加工費の計算（データの保存と取得）<br>
                バックエンド：画像処理（テキストの取得、図形の取得、接戦の計算）<br><br>
  
                フロントエンドでは、ユーザーが効率的に作業できるように、ドラッグ&ドロップ機能のサポート、<br>
                見やすいUIと可能な限りの自動化を目指しました。<br>
                ほとんどの項目は数値の手入力形式としつつ、<br>
                一部はメニューから選択できるようにしています。<br>
                また、加工費の計算は大きな項目であるため、見積もりとは別の画面を設けました。<br>
  
                バックエンドでは、検出精度の向上を最優先し、複数の機能を併用して精度を高めています。
                
              </p>
              
              <h4>技術スタック</h4>
              <li>プログラミング言語: python</li>
              <li>GUIライブラリ: Tkinter</li>
              <li>ウェブスクレイピング: Selenium</li>
              <li>画像処理: pytesseract, pyocr, cv2</li>
              <li>データ保存形式: jsonファイル</li>
              <li>開発環境: Visual Studio Code</li>
  
              <h3>環境選定</h3>
              <p>
                もともとJavaScriptを学んでいたため、次のステップとしてPythonを試してみたかったことが選定のきっかけです。<br>
                また、複雑なロジックとデータ処理への関心から、バックエンドの作成に挑戦しました。<br><br>
  
                画像処理には、正確なテキスト検出や図形認識など複数の機能が必要であり、<br>
                処理のリソース効率を考えてGUIには軽量なTkinterを採用。<br>
                ウェブスクレイピングには、以前使用経験があり信頼性のあるSeleniumを選択しています。<br>
                さらに、保存形式にはJavaScriptで扱い慣れていたJSONを選びました。<br><br>
                
                デバッグやテストのしやすさも考慮してPythonやTkinter、Seleniumが最適だと考えました。<br>
              </p>

              <h3>主な機能</h3>
              <figure>
                <h4>材料費取得（スクレイピング）</h4>                  
                <div class="image-group">
                  <img src="img/emu01.png" alt="">
                  <img src="img/emu02.png" alt="">
                </div>
                <figcaption>
                  <p>
                    幅・高さ・奥行きをmm単位で入力し「材料費取得」ボタンを押すと、<br>
                    外部ウェブサイトから最新の材料費を自動的に取得され、計算フィールドに反映されます。<br>
                    また、材料の右側にあるドロップダウンメニューの項目から材料を選択することで、<br>
                    対応するWebページから材料費をスクレイピングすることが可能です。<br>

                    *著作権については対象ウェブサイト側で非営利目的の利用が許可されていることを確認済みです。<br>
                    ただし、利用規約の変更に注意しながら、データの取得にはスクレイピングポリシーに従っています。<br>
                  </p>
                </figcaption>
              </figure>

              <figure>
                <h4>計算機（tkinter）</h4>                  
                <div class="image-group">
                  <img src="img/task01.png" alt="">
                  <img src="img/task02.png" alt="">
                  <img src="img/task03.png" alt="">
                </div>
                <figcaption>
                  <p>
                    加工コストの計算は大きく場所を取るため、別の画面を作ることで対応しました。<br>
                    見積もり画面の「加工コストの計算」ボタンを押すことで加工計算ソフトが立ち上がります。<br>
                    加工計算ソフトの画面では「加工名を追加」ボタンを押すことで、加工名と各パラメーターを記入できます。<br>
                    「計算」ボタンを押すことで合計値を出力、「終了」ボタンを押して画面を閉じると<br>
                    出力した合計値は見積もりの加工コストのフィールドに出力されます。<br>
                  </p>
                </figcaption>
              </figure>

              <figure>
                <h4>画像処理</h4>
                <div class="image-group">
                  <img src="img/ocr01.png" alt="">
                  <img src="img/ocr03.png" alt="">
                  <img src="img/ocr02.png" alt="">
                </div>
                <figcaption>
                  <p>
                    「画像読み込み」ボタンの横のフィールドに画像ファイル名を入力しボタンを押すと、<br>
                    画像処理が始まり結果をjsonファイルに保存。<br>
                    検出機能にはcv2,pyocr,pytesseractの3つを使用し精度の高い検出を実現しています。<br>
                  </p>
                    <div class="line-container">
                    <div class="green_line"><b>検出された円</b></div>
                    <div class="red_line"><b>円の接線 </b></div>
                    <div class="blue_line"><b>その他の検出された線</b></div>
                  </div>
                </figcaption>
              </figure>

            </div>



            <h3>コーディング</h3>
            <h4>見積もり</h4>
              <h5>スクレイピング</h5>
              <p>
                Seleniumでのスクレイピング、選択した材料に応じて、<br>
                外部ウェブサイトから最新の材料費を自動的に取得します。
              </p>
              <h5>加工コストの計算</h5>
              <p>
                加工にかかるコスト計算は大きい項目のため別の画面を立ち上げ対応しました。<br>
                最終的な見積もりに組み込みます。
              </p>
              <h5>画像認識機能</h5>
              <p>
                 画像からデータを読み取るOCR機能を統合し、手動入力を削減します。
                </p>

            <h4>加工費計算</h4>
              <h5>Frameの構成</h5>
              <p>
                Canvasの中にFrameを入れることでスクロールすることを可能にし、<br>
                配置したFrameの内容をスクロールで表示することができます。
              </p>
              <h5>ファイルのロードと保存</h5>
              <p>
                ファイルからのデータ復元や、ファイル名を指定してのセーブが可能です。<br>
                コマンドライン引数にchan を指定することで、画像処理を行った場合はchan == 1になり<br>
                orc_data.jsonをロードし、ボタンの自動クリックが発動します。
              </p>


            <h4>画像処理</h4>
              <h5>主要なプロセス</h5>
              <p>
                ユーザーから取得した入力データを解析し、<br>
                加工内容や精度、数量などのパラメータ情報を整理して、JSON形式で保存します。<br>
                このプロセスには、正規表現を用いたテキスト解析や条件に基づくパラメータ抽出が含まれます。
              </p>
              
              <h5>検索機能</h5>
              <p>
                図面からOCRによってテキストを取得し、加工に関するキーワードのみを検出します。<br>
                正規表現を使用してテキスト内の単語や数値を抽出し、加工内容を特定するためのデータを作成します。
              </p>
              
              <h5>接触判定</h5>
              <p>
                取得したテキストが加工に関わるものかを確認するため、cv2で図形の検出、<br>  
                pytesseractでテキスト位置情報を取得し、指定された図形に接している線、<br>  
                もしくはその線に接続する線を検出、その線の上にテキストがあるかを判定します。<br>            
                また、指定された条件に基づき、図形が接触しているかをベクトル計算で検出し、<br>
                接触する線の位置や方向を解析して加工対象の位置を正確に特定します。
              </p>
              
              <h5>スケールアップ処理・フィルタリング処理</h5>
              <p>
                通常サイズの画像では検出が難しい線などがある場合、<br>
                モノクロ度合いや画像サイズを調整し、検出精度を向上させます。
              </p>
              
              <h5>JSON形式への保存</h5>
              <p>
                加工費計算に使用するためのJSONファイルを作成します。<br>
                このファイルには加工の種類や各パラメータが含まれます。
              </p>


            <h3>改善点・今後の展望</h3>

            <p>
              読み込んだ画像をそのままファイル名にする。加工計算のボタンは別フレームに置く

            </p>

            <h4>穴加工以外の取得</h4>
            <p>
              現在、画像処理によって取得できる加工は、タップやドリルといった穴加工のみです。<br>
              今後は、全ての加工に対応できる仕組みを考えていきたいと考えています。そのためには、<br>
              不要な線の選択を除外し、三角法に対応したシステム、さらに各加工に適したアルゴリズムを導入する必要があります。<br>
              これらの問題は、cv2の形状解析機能やアフィン変換機能を活用することで解決できる可能性があります。
            </p>
            <h4>複雑な画像の処理</h4>
            <p>
              現在の方法では、テキストを円や線と誤認識することがあるため、テキストの四方の位置情報を取得し、<br>
              その範囲を塗りつぶした後に図形の検出を行う手順に変更する必要があります。
            </p>
            <h4>作図</h4>
            <p>
              OCRの接線描写機能を活用すれば、加工計算ソフトを転用して値から図面を作成することが可能です。<br>
              素人に作図させる企業が少なからず存在すると聞いているため、需要が見込まれます。
            </p>
            <h4>Webでの利用</h4>
            <p>
              Webでの利用は未経験ですが、挑戦してみたいと考えています。<br>
              ただし、デプロイに関する知識が曖昧なため、勉強を進める必要があります。
            </p>
            

          </div>
          <div class="home-link">
            <a href="./#works">Works一覧へ</a>
          </div>
        </div>
      </article>

      <div class="page-top" id="js-page-top">
        <span class="material-icons-outlined">expand_less</span>
      </div>
    </main>

    <!-- footer -->
    <footer class="footer">
      <div class="copyright">&copy;TARO YAMADA</div>
    </footer>
    <!-- /footer -->

  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script type='text/javascript' src="js/script.js"></script>
</body>
</html>